function enableDisableButton(){hasPhoneError||hasEmailError?$("form").find(".common_button").prop("disabled",!0):$("form").find(".common_button").prop("disabled",!1)}function updatePhoneInfo(){let e=new Promise(function(e,t){hasPhoneError=!0,enableDisableButton(),$("#defaultCountry").val($("#phone").intlTelInput("getSelectedCountryData").iso2),$("#carrierCode").val($("#phone").intlTelInput("getSelectedCountryData").dialCode),""!=$("#phone").val&&$("#formattedPhone").val($("#phone").intlTelInput("getNumber").replace(/-|\s/g,"")),e()});return hasPhoneError=!1,enableDisableButton(),e}function checkDuplicatePhoneNumber(){$.post({url:duplicatePhoneCheckUrl,dataType:"json",data:{_token:csrfToken,phone:$.trim($("#phone").val()),carrierCode:$.trim($("#phone").intlTelInput("getSelectedCountryData").dialCode),id:userId}}).done(function(e){e.status?($("#phone-error").show().addClass("error").html(e.fail),hasPhoneError=!0,enableDisableButton()):($("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})}function validateInternaltionalPhoneNumber(){let e=new Promise(function(e,t){let o=!1;""!==$.trim($("#phone").val())?$("#phone").intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($("#phone").val()))?(o=!0,$("#tel-error").html(""),hasPhoneError=!1,enableDisableButton()):($("#phone-error").html(""),$("#tel-error").addClass("error").html(validPhoneNumberErrorText),hasPhoneError=!0,enableDisableButton()):($("#tel-error").html(""),hasPhoneError=!1,enableDisableButton()),e(o)});return e}var hasPhoneError=!1,hasEmailError=!1;$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:[countryShortCode],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",utilsScript:utilsScriptLoadingPath}),null!==formattedPhoneNumber&&null!==defaultCountry&&null!==carrierCode&&($("#phone").intlTelInput("setNumber",formattedPhoneNumber),$("#defaultCountry").val(defaultCountry),$("#carrierCode").val(carrierCode),$("#formattedPhone").val(formattedPhoneNumber)),$(document).ready(function(){let e=$("#is_sms_env_enabled").val(),t=$("#checkPhoneVerification").val();!e&&"Enabled"!=t||"Enabled"!=t?formattedPhoneNumber?$(".next").removeClass("next").addClass("edit_form_submit").html(updatePhoneText):$(".next").removeClass("next").addClass("form_submit").html(submitText):$(".next").removeClass("form_submit").addClass("next").html(nextText)}),$(document).on("click",".next",function(){let e=$("input[name=phone]");if(""==e.val())return $("#phone-number-error").addClass("error").html(fieldRequiredText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),!1;if(e.hasClass("error"))return!1;{$(".modal-title").html(getCodeText),$("#subheader_text").html(verificationCodeText),$("#static_phone_show").show(),$(".edit").show(),$(this).removeClass("next").addClass("get_code").html(getCodeText);let e=$("#phone").intlTelInput("getNumber");return $("#static_phone_show").html(e+"&nbsp;&nbsp;"),!0}}),$(document).on("click",".get_code",function(){let e=$("#phone").intlTelInput("getSelectedCountryData").dialCode,t=$("#phone").intlTelInput("getNumber");$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:getVerificationCodeUrl,dataType:"json",cache:!1,data:{phone:t,carrierCode:e}}).done(function(e){e.status?($(".modal-title").html(verifyPhoneText),$(".phone_group").hide(),$(".static_phone_show").html(""),$("#subheader_text").html(smsCodeSentText+"<br><br>"+smsCodeSubmitText),$(".edit").hide(),$("#phone_verification_code").val(""),$(".phone_verification_section").removeClass("d-none"),$(".get_code").removeClass("get_code").addClass("verify").html(verifyText),$("#hasVerificationCode").val(e.message)):($("#message").removeClass("d-none"),$("#message").html(smsFailText))})}),$(document).on("click",".verify",function(){let e=$("#phone_verification_code").val(),t=$("#phone").intlTelInput("getNumber"),o=$("#phone").intlTelInput("getSelectedCountryData").dialCode,n=$("#phone").intlTelInput("getSelectedCountryData").iso2;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:completeVerificationCodeUrl,dataType:"json",cache:!1,data:{phone:t,defaultCountry:n,carrierCode:o,phone_verification_code:e}}).done(function(e){e.status&&500!=e.status?($("#message").removeClass("error"),$("#message").addClass("d-none"),$("#message").html(),$("#subheader_text").html(),$(".phone-text").html(t),$(".phone_verification_section").addClass("d-none"),$("#subheader_text").html(""),$("#close").hide(),$(".common_button").removeClass("verify").addClass("next").html(nextText),$(".modal-title").html(updatePhoneText),$(".phone_group").show(),$("#exampleModal-4").modal("toggle"),swal({title:successText,text:e.message,icon:"success",closeOnClickOutside:!1,closeOnEsc:!1})):($("#message").removeClass("d-none"),$("#message").html(e.message),$("#message").addClass(e.error))})}),$(document).on("click",".form_submit",function(){let e=$("#phone").intlTelInput("getNumber"),t=$("#phone").intlTelInput("getSelectedCountryData").iso2,o=$("#phone").intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:phoneNumberAddUrl,dataType:"json",cache:!1,data:{phone:e,defaultCountry:t,carrierCode:o}}).done(function(t){t.status&&($(".phone-text").html(e),$("#exampleModal-4").modal("toggle"),swal({title:successText,text:t.message,icon:"success",closeOnClickOutside:!1,closeOnEsc:!1}),$(".form_submit").removeClass("form_submit").addClass("edit_form_submit").html(submitText),$(".modal-title").html(updatePhoneText))})}),$("#editModal").on("hidden.bs.modal",function(){""!=$("#edit_phone").val()&&($("#edit_phone").val(`+${OrginalUsercarrierCode}${OrginalUserphone}`),window.location.reload())}),$(document).ready(function(){$("#edit_phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:["us"],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",formatOnDisplay:!1,utilsScript:utilsScriptLoadingPath})}),$(document).on("click",".edit_form_submit",function(){let e=$("#phone").intlTelInput("getNumber"),t=$("#phone").intlTelInput("getSelectedCountryData").iso2,o=$("#phone").intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:phoneNumberUpdateUrl,dataType:"json",cache:!1,data:{phone:e,flag:t,code:o}}).done(function(t){t.status&&($(".phone-text").html(e),$("#exampleModal-4").modal("toggle"),swal({title:successText,text:t.message,icon:"success",closeOnClickOutside:!1,closeOnEsc:!1}),$("#message").css("display","block"),$("#message").html(t.message),$("#message").addClass(t.class_name),$("#close").hide())})});